# Week 2 - Action Item Extractor

## TODO 5 è§£ç­”ï¼šè‡ªå‹•ç”¢ç”Ÿçš„ README æ–‡ä»¶

---

## ğŸ“‹ å°ˆæ¡ˆæ¦‚è¿°

**Action Item Extractor** æ˜¯ä¸€å€‹åŸºæ–¼ FastAPI çš„ Web æ‡‰ç”¨ç¨‹å¼ï¼Œèƒ½å¤ å¾è‡ªç”±æ ¼å¼çš„ç­†è¨˜æ–‡å­—ä¸­è‡ªå‹•æŠ½å–è¡Œå‹•é …ç›®ï¼ˆaction itemsï¼‰ã€‚æœ¬å°ˆæ¡ˆæ”¯æ´å…©ç¨®æŠ½å–æ–¹å¼ï¼š

1. **å•Ÿç™¼å¼æŠ½å–ï¼ˆHeuristicï¼‰**ï¼šä½¿ç”¨æ­£å‰‡è¡¨é”å¼èˆ‡é—œéµå­—æ¯”å°
2. **LLM æŠ½å–ï¼ˆLarge Language Modelï¼‰**ï¼šé€é Ollama å‘¼å«æœ¬åœ°å¤§å‹èªè¨€æ¨¡å‹

### ä¸»è¦åŠŸèƒ½

- âœ… å¾ç­†è¨˜ä¸­è­˜åˆ¥ä¸¦æŠ½å–å¾…è¾¦äº‹é …
- ğŸ“ å„²å­˜ç­†è¨˜ä¸¦é—œè¯æŠ½å–çš„è¡Œå‹•é …ç›®
- âœ”ï¸ æ¨™è¨˜è¡Œå‹•é …ç›®ç‚ºå·²å®Œæˆ
- ğŸ¤– æ”¯æ´ AI è¼”åŠ©æŠ½å–ï¼ˆé€é Ollamaï¼‰
- ğŸ“Š çµ±è¨ˆè³‡è¨Šé¡¯ç¤º

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

### å‰ç½®éœ€æ±‚

- Python 3.10+
- Poetryï¼ˆå¥—ä»¶ç®¡ç†ï¼‰
- Condaï¼ˆè™›æ“¬ç’°å¢ƒï¼Œå¯é¸ï¼‰
- Ollamaï¼ˆè‹¥è¦ä½¿ç”¨ LLM æŠ½å–åŠŸèƒ½ï¼‰

### å®‰è£èˆ‡è¨­å®š

1. **å•Ÿç”¨è™›æ“¬ç’°å¢ƒ**

```bash
conda activate cs146s
```

2. **å®‰è£ä¾è³´å¥—ä»¶**

```bash
poetry install
```

3. **è¨­å®šç’°å¢ƒè®Šæ•¸**ï¼ˆå¯é¸ï¼‰

å»ºç«‹ `.env` æª”æ¡ˆï¼š

```env
OLLAMA_MODEL=llama3.2:1b
```

4. **å•Ÿå‹• Ollama**ï¼ˆè‹¥ä½¿ç”¨ LLM åŠŸèƒ½ï¼‰

```bash
# ä¸‹è¼‰ä¸¦å•Ÿå‹•æ¨¡å‹
ollama run llama3.2:1b
```

### å•Ÿå‹•æ‡‰ç”¨ç¨‹å¼

```bash
# å¾å°ˆæ¡ˆæ ¹ç›®éŒ„åŸ·è¡Œ
poetry run uvicorn week2.app.main:app --reload
```

æ‡‰ç”¨ç¨‹å¼å°‡åœ¨ http://127.0.0.1:8000/ å•Ÿå‹•ã€‚

---

## ğŸ“¡ API ç«¯é»

### ç­†è¨˜ç›¸é—œ (Notes)

| æ–¹æ³• | ç«¯é» | èªªæ˜ |
|------|------|------|
| `POST` | `/notes` | å»ºç«‹æ–°ç­†è¨˜ |
| `GET` | `/notes` | åˆ—å‡ºæ‰€æœ‰ç­†è¨˜ |
| `GET` | `/notes/{id}` | å–å¾—ç‰¹å®šç­†è¨˜ |
| `DELETE` | `/notes/{id}` | åˆªé™¤ç­†è¨˜ |

#### å»ºç«‹ç­†è¨˜ç¯„ä¾‹

```bash
curl -X POST http://127.0.0.1:8000/notes \
  -H "Content-Type: application/json" \
  -d '{"content": "Meeting notes: discuss project timeline"}'
```

### è¡Œå‹•é …ç›®ç›¸é—œ (Action Items)

| æ–¹æ³• | ç«¯é» | èªªæ˜ |
|------|------|------|
| `POST` | `/action-items/extract` | å•Ÿç™¼å¼æŠ½å–è¡Œå‹•é …ç›® |
| `POST` | `/action-items/extract-llm` | LLM æŠ½å–è¡Œå‹•é …ç›® |
| `GET` | `/action-items` | åˆ—å‡ºæ‰€æœ‰è¡Œå‹•é …ç›® |
| `POST` | `/action-items/{id}/done` | æ¨™è¨˜ç‚ºå®Œæˆ |
| `DELETE` | `/action-items/{id}` | åˆªé™¤è¡Œå‹•é …ç›® |

#### å•Ÿç™¼å¼æŠ½å–ç¯„ä¾‹

```bash
curl -X POST http://127.0.0.1:8000/action-items/extract \
  -H "Content-Type: application/json" \
  -d '{
    "text": "- [ ] Set up database\n- Implement API\nTODO: Write tests",
    "save_note": true
  }'
```

#### LLM æŠ½å–ç¯„ä¾‹

```bash
curl -X POST http://127.0.0.1:8000/action-items/extract-llm \
  -H "Content-Type: application/json" \
  -d '{
    "text": "We need to schedule a meeting next week and prepare the presentation.",
    "save_note": false,
    "model": "llama3.2:1b"
  }'
```

### å¥åº·æª¢æŸ¥èˆ‡çµ±è¨ˆ

| æ–¹æ³• | ç«¯é» | èªªæ˜ |
|------|------|------|
| `GET` | `/health` | å¥åº·æª¢æŸ¥ |
| `GET` | `/stats` | å–å¾—çµ±è¨ˆè³‡è¨Š |
| `GET` | `/api/info` | API è³‡è¨Š |

---

## ğŸ—‚ï¸ å°ˆæ¡ˆçµæ§‹

```
week2/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ db.py                 # è³‡æ–™åº«æ“ä½œ
â”‚   â”œâ”€â”€ db_ans.py             # é‡æ§‹å¾Œçš„è³‡æ–™åº«å±¤
â”‚   â”œâ”€â”€ main.py               # FastAPI æ‡‰ç”¨ç¨‹å¼
â”‚   â”œâ”€â”€ main_ans.py           # é‡æ§‹å¾Œçš„ä¸»ç¨‹å¼
â”‚   â”œâ”€â”€ schemas_ans.py        # Pydantic è³‡æ–™æ¨¡å‹
â”‚   â”œâ”€â”€ routers/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ notes.py          # ç­†è¨˜è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ notes_ans.py      # é‡æ§‹å¾Œçš„ç­†è¨˜è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ action_items.py   # è¡Œå‹•é …ç›®è·¯ç”±
â”‚   â”‚   â””â”€â”€ action_items_ans.py  # æ–°å¢ LLM ç«¯é»
â”‚   â””â”€â”€ services/
â”‚       â”œâ”€â”€ extract.py        # æŠ½å–æœå‹™
â”‚       â””â”€â”€ extract_ans.py    # æ–°å¢ LLM æŠ½å–
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ index.html            # åŸå§‹å‰ç«¯
â”‚   â””â”€â”€ index_ans.html        # æ›´æ–°å¾Œå‰ç«¯ï¼ˆå« LLM æŒ‰éˆ•ï¼‰
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ test_extract.py       # åŸå§‹æ¸¬è©¦
â”‚   â””â”€â”€ test_extract_ans.py   # æ–°å¢ LLM æ¸¬è©¦
â”œâ”€â”€ data/
â”‚   â””â”€â”€ app.db                # SQLite è³‡æ–™åº«ï¼ˆè‡ªå‹•å»ºç«‹ï¼‰
â”œâ”€â”€ assignment.md             # ä½œæ¥­èªªæ˜
â”œâ”€â”€ writeup.md                # ä½œæ¥­å ±å‘Š
â””â”€â”€ README_ans.md             # æœ¬æ–‡ä»¶
```

---

## ğŸ§ª åŸ·è¡Œæ¸¬è©¦

### åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦

```bash
# å¾å°ˆæ¡ˆæ ¹ç›®éŒ„
poetry run pytest week2/tests/ -v
```

### åŸ·è¡Œç‰¹å®šæ¸¬è©¦æª”æ¡ˆ

```bash
# æ¸¬è©¦åŸæœ‰çš„å•Ÿç™¼å¼æŠ½å–
poetry run pytest week2/tests/test_extract.py -v

# æ¸¬è©¦æ–°å¢çš„ LLM æŠ½å–
poetry run pytest week2/tests/test_extract_ans.py -v
```

### æ¸¬è©¦è¦†è“‹ç‡

```bash
poetry run pytest week2/tests/ --cov=week2 --cov-report=html
```

---

## ğŸ”§ æŠ½å–æ–¹æ³•èªªæ˜

### å•Ÿç™¼å¼æŠ½å–ï¼ˆHeuristicï¼‰

ä½¿ç”¨ä»¥ä¸‹è¦å‰‡è­˜åˆ¥è¡Œå‹•é …ç›®ï¼š

1. **ç¬¦è™Ÿå‰ç¶´**ï¼š`-`ã€`*`ã€`â€¢`ã€`1.`ã€`2.` ç­‰
2. **é—œéµå­—å‰ç¶´**ï¼š`TODO:`ã€`ACTION:`ã€`NEXT:`
3. **å‹¾é¸æ¡†**ï¼š`[ ]`ã€`[todo]`
4. **ç¥ˆä½¿å¥**ï¼ˆfallbackï¼‰ï¼šä»¥å‹•è©é–‹é ­çš„å¥å­

### LLM æŠ½å–

ä½¿ç”¨ Ollama æœ¬åœ°æ¨¡å‹é€²è¡Œæ™ºæ…§åˆ†æï¼š

1. æ”¯æ´è‡ªç„¶èªè¨€æè¿°ä¸­çš„éš±å«ä»»å‹™
2. ä½¿ç”¨çµæ§‹åŒ–è¼¸å‡ºç¢ºä¿æ ¼å¼æ­£ç¢º
3. å¤±æ•—æ™‚è‡ªå‹•å›é€€åˆ°å•Ÿç™¼å¼æ–¹æ³•

---

## ğŸ“ API æ–‡ä»¶

å•Ÿå‹•æ‡‰ç”¨ç¨‹å¼å¾Œï¼Œå¯é€éä»¥ä¸‹æ–¹å¼å­˜å– API æ–‡ä»¶ï¼š

- **Swagger UI**: http://127.0.0.1:8000/docs
- **ReDoc**: http://127.0.0.1:8000/redoc

---

## âš™ï¸ ç’°å¢ƒè®Šæ•¸

| è®Šæ•¸åç¨± | èªªæ˜ | é è¨­å€¼ |
|----------|------|--------|
| `OLLAMA_MODEL` | Ollama æ¨¡å‹åç¨± | `llama3.2:1b` |

---

## ğŸ› å¸¸è¦‹å•é¡Œ

### Q: LLM æŠ½å–å¤±æ•—æ€éº¼è¾¦ï¼Ÿ

A: ç¢ºèª Ollama æœå‹™å·²å•Ÿå‹•ï¼š

```bash
ollama serve
```

### Q: è³‡æ–™åº«ä½ç½®åœ¨å“ªè£¡ï¼Ÿ

A: è³‡æ–™åº«æª”æ¡ˆä½æ–¼ `week2/data/app.db`ï¼Œæœƒè‡ªå‹•å»ºç«‹ã€‚

### Q: å¦‚ä½•é‡ç½®è³‡æ–™åº«ï¼Ÿ

A: åˆªé™¤ `week2/data/app.db` æª”æ¡ˆï¼Œé‡å•Ÿæ‡‰ç”¨ç¨‹å¼å³å¯ã€‚

---

## ğŸ“„ æˆæ¬Š

æœ¬å°ˆæ¡ˆç‚º CS146S èª²ç¨‹ä½œæ¥­çš„ä¸€éƒ¨åˆ†ã€‚
